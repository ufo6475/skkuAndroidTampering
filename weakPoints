2022 소프트웨어학과 졸업작품

*취약점 분석

<2022/03/13 updates>
1. 주요 activity file 명 모두 난독화 되지 않고 그대로 보존
2. 알림 메시지등에 사용되는 string들 모두 messages.xml, config.xml에 그대로 보존
3. 이를 토대로 어떤 class인지 추측 가능
4. 특정 class에서 int 값이  특정 값에 도달하면 macro 방지 코드를 호출 하는 구문 발견
5. 해당 구문 값을 smali 코드 내에서 특정횟수에서 0회로 변경 -> macro 방지 코드 실행 x (test-1)
6. 변경된 코드로 리패키징과 사이닝을 통해 emulator로 실행
7. emulator 및 루팅 여부를 감지하는 코드로 인해 실행 x
8. emulator 감지 코드 확인 -> 감지되어도 그대로 진행되게 smali 코드 변경 -> 회피 성공 (test-2)
9. 로그인 창 접속 후 id/pw 입력 후 로그인 클릭시 '리패키징이 감지되어 앱 종료' 알림과 앱 종료됨
10. 서버 측에서 앱의 서명값을 기존의 서명값과 비교하여 리패키징을 감지하는 것으로 추측
11. 앱의 서명값을 받아내는 코드 java 파일 내에서 발견
12. 정상 앱의 서명값 추출 성공
13. smali 코드 에서 앱의 서명 값을 받아낸 이후에 정상 앱의 서명값 덮어씀
14. 리패키징과 사이닝을 통해 다시 로그인 해본 결과 리패키징 감지 회피에 성공( test-3)


<2022/04/19 updates>
1. 기존의 특정 int 값에서 macro 방지 코드 실시 하는 것이 특정 횟수가 아닌 message 번호(118)를 뜻하는 것이었음.
2. log로 받은 값이 해당 값인 경우 매크로 방지 코드가 작동함.
3. 이러한 번호를 조작하여 해당 매크로 방지 코드가 작동하지 않게 변경
4. 오토핫키 매크로 프로그램을 통하여 안드로이드스튜디오 emulator 환경에서 매크로 방지에 탐지되는지 검사
5. 특정횟수가 넘어가면 매크로 방지는 나오지 않지만 알수없는 헥사코드가 출력됨
6. 변조되지않은 어플리케이션으로 들어갔을때 바로 매크로 방지 출력
7. 해당 매크로 횟수는 서버측에서 관리하는 것으로 확인
8. message.xml에 없는 메시지 값들은 서버측에서 xmlPullParser를 통해 가져오는 것 확인




<예정>
1. 신청 클릭시 어떤 흐름으로 작동되는 지 파악 후 여기서 코드 변경점 탐색
2. 매크로 방지 클릭 횟수를 서버측에서 확인한다면 이를 회피할 방법 모색 혹은 매크로 방지 코드가 호출되면 바로 서버측으로 해당 정답 전송 방안 모색
3. 한 버튼 클릭시 모두 신청되는 방안 모색
